{
  "Dumping": {
    "situation": "Dumping",
    "startQuestionId": "dump-thoughts-text",
    "questions": [
      {
        "id": "dump-thoughts-text",
        "question": "나의 생각을 자유롭게 작성해주세요",
        "type": "text",
        "required": true,
        "nextQuestionId": "dump-complete",
        "showData": {
          "type": "previous-cycle",
          "label": "이전 Cycle 내용",
          "source": "getPreviousCycleData"
        },
        "aiPromptTemplate": {
          "template": "# 생각 정리 도움\n\n## [INPUT – Human]\n\n1. 현재 생각:\n- {{dump-thoughts-text}}\n\n2. 이전 Cycle 내용 (선택적):\n{{previous-cycle}}\n\n## [AI PROMPT]\n\nYou are helping to organize thoughts.\n\nTasks:\n1. Identify key themes and patterns in the thoughts.\n2. Extract actionable insights.\n3. Suggest areas that need clarification.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Thoughts are organized\n- Key themes identified"
        }
      },
      {
        "id": "dump-complete",
        "question": "생각 정리가 완료되었나요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "WhatToDo",
        "onNoNextQuestionId": "dump-thoughts-text"
      }
    ]
  },
  "WhatToDo": {
    "situation": "WhatToDo",
    "startQuestionId": "action-intent-text",
    "questions": [
      {
        "id": "action-intent-text",
        "question": "지금 하고 싶은 행동/일을 작성해주세요",
        "type": "text",
        "required": true,
        "nextQuestionId": "action-intent-clear",
        "showData": {
          "type": "dump-thoughts",
          "label": "Dumping 단계에서 작성한 생각",
          "source": "getAnswerByQuestionId",
          "sourceParam": "dump-thoughts-text"
        },
        "aiPromptTemplate": {
          "template": "# 하고 싶은 행동/일 정리 도움\n\n## [INPUT – Human]\n\n1. Dumping 단계의 생각:\n- {{dump-thoughts-text}}\n\n2. 하고 싶은 행동/일:\n- {{action-intent-text}}\n\n## [AI PROMPT]\n\nYou are helping to clarify what the user wants to do.\n\nTasks:\n1. Clarify what action or task the user wants to do.\n2. Identify the motivation behind it.\n3. Extract assumptions about the action.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- What the user wants to do is clear\n- Motivation identified"
        }
      },
      {
        "id": "action-intent-clear",
        "question": "하고 싶은 행동/일이 명확한가요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "DefiningIntent",
        "onNoNextQuestionId": "action-intent-text"
      }
    ]
  },
  "DefiningIntent": {
    "situation": "DefiningIntent",
    "startQuestionId": "intent-why-action",
    "questions": [
      {
        "id": "intent-why-action",
        "question": "이 행동/일을 하고 싶은 이유를 작성해주세요 (왜 이 행동/일이 필요한지, 어떤 문제나 불편함을 해결하려는지)",
        "type": "text",
        "required": true,
        "nextQuestionId": "intent-assumptions",
        "showData": {
          "type": "action-intent",
          "label": "하고 싶은 행동/일",
          "source": "getAnswerByQuestionId",
          "sourceParam": "action-intent-text"
        },
        "aiPromptTemplate": {
          "template": "# 하고 싶은 행동/일의 이유 정리 도움\n\n## [INPUT – Human]\n\n1. Dumping 단계의 생각:\n- {{dump-thoughts-text}}\n\n2. 하고 싶은 행동/일:\n- {{action-intent-text}}\n\n## [AI PROMPT]\n\nYou are helping to clarify the reasons for what the user wants to do.\n\nTasks:\n1. Consider the thoughts from the Dumping phase.\n2. Based on the action/task the user wants to do, help identify the core motivations.\n3. Extract underlying needs or desires that might drive this action.\n4. Identify what problem or discomfort this action aims to solve.\n5. Suggest potential reasons why the user wants to do this action.\n\nImportant: Focus on WHY the user wants to do this action, not WHAT they will do or HOW they will do it.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Potential reasons identified\n- Motivations suggested"
        }
      },
      {
        "id": "intent-assumptions",
        "question": "이 행동/일에 대한 가정을 작성해주세요 (이 행동/일이 효과적일 것이라고 가정하는 것, 또는 이 행동/일을 하기 전에 참이라고 가정하는 것)",
        "type": "text",
        "required": true,
        "nextQuestionId": "intent-summary-text",
        "showData": {
          "type": "why-action",
          "label": "행동/일을 하고 싶은 이유",
          "source": "getAnswerByQuestionId",
          "sourceParam": "intent-why-action"
        },
        "aiPromptTemplate": {
          "template": "# 가정 정리 도움\n\n## [INPUT – Human]\n\n1. Dumping 단계의 생각:\n- {{dump-thoughts-text}}\n\n2. 하고 싶은 행동/일:\n- {{action-intent-text}}\n\n3. 행동/일을 하고 싶은 이유:\n- {{intent-why-action}}\n\n## [AI PROMPT]\n\nYou are helping to identify and validate assumptions.\n\nTasks:\n1. Consider the thoughts from the Dumping phase.\n2. Based on the action intent and reasons, extract hidden assumptions.\n3. Identify what the user assumes to be true before taking this action.\n4. Identify assumptions about the effectiveness or outcome of this action.\n5. Identify assumptions that might be incorrect or need validation.\n6. Suggest ways to validate these assumptions.\n\nImportant: Focus on ASSUMPTIONS (what is assumed to be true), not reasons (why) or the action itself (what).\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Assumptions identified\n- Validation methods suggested"
        }
      },
      {
        "id": "intent-summary-text",
        "question": "위에서 작성한 내용을 바탕으로 의도를 한 문장으로 요약해주세요 (행동/일, 이유, 가정을 종합하여)",
        "type": "text",
        "required": true,
        "nextQuestionId": "intent-consistent",
        "showData": {
          "type": "intent-summary",
          "label": "기존 Intent 요약",
          "source": "getIntentSummary"
        },
        "aiPromptTemplate": {
          "template": "# 의도 요약 도움\n\n## [INPUT – Human]\n\n1. Dumping 단계의 생각:\n- {{dump-thoughts-text}}\n\n2. 하고 싶은 행동/일:\n- {{action-intent-text}}\n\n3. 행동/일을 하고 싶은 이유:\n- {{intent-why-action}}\n\n4. 가정:\n- {{intent-assumptions}}\n\n## [AI PROMPT]\n\nYou are helping to summarize intent.\n\nTasks:\n1. Consider the thoughts from the Dumping phase.\n2. Synthesize what the user wants to do, reasons, and assumptions into one clear sentence.\n3. Ensure the summary captures the essence without losing important context from the Dumping phase.\n4. The summary should integrate: what action/task, why it's needed, and key assumptions.\n\nImportant: This is a SUMMARY that combines all the above information into one sentence, not a repetition of any single part.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Intent is one clear sentence\n- All key elements included"
        }
      },
      {
        "id": "intent-consistent",
        "question": "설명할 때마다 내용이 일관되나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "intent-no-tech",
        "onNoNextSituation": "FailingIntent"
      },
      {
        "id": "intent-no-tech",
        "question": "기능이나 기술을 언급하지 않았나요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "SelectingProblem",
        "onNoNextSituation": "FailingIntent"
      }
    ]
  },
  "FailingIntent": {
    "situation": "FailingIntent",
    "startQuestionId": "intent-unclear-what",
    "questions": [
      {
        "id": "intent-unclear-what",
        "question": "어떤 부분이 불명확한가요?",
        "type": "text",
        "required": true,
        "nextQuestionId": "intent-clarify-questions"
      },
      {
        "id": "intent-clarify-questions",
        "question": "명확히 하기 위한 질문을 작성했나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "intent-clarify-questions-text",
        "onNoNextQuestionId": "intent-clarify-questions-text"
      },
      {
        "id": "intent-clarify-questions-text",
        "question": "명확히 하기 위한 질문을 작성해주세요",
        "type": "text",
        "required": true,
        "nextQuestionId": "intent-ready-rewrite"
      },
      {
        "id": "intent-ready-rewrite",
        "question": "Intent를 다시 작성할 준비가 되었나요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "DefiningIntent",
        "onNoNextQuestionId": "intent-ready-rewrite"
      }
    ]
  },
  "SelectingProblem": {
    "situation": "SelectingProblem",
    "startQuestionId": "problem-boundaries-text",
    "questions": [
      {
        "id": "problem-boundaries-text",
        "question": "문제의 경계를 명확히 작성해주세요 (포함/제외)",
        "type": "text",
        "required": true,
        "nextQuestionId": "problem-distinct",
        "showData": {
          "type": "intent-summary",
          "label": "의도 요약",
          "source": "getIntentSummary"
        },
        "aiPromptTemplate": {
          "template": "# 문제 선택 및 경계 정의 도움\n\n## [INPUT – Human]\n\n1. Dumping 단계의 생각:\n- {{dump-thoughts-text}}\n\n2. 하고 싶은 행동/일:\n- {{action-intent-text}}\n\n3. 행동/일을 하고 싶은 이유:\n- {{intent-why-action}}\n\n4. 가정:\n- {{intent-assumptions}}\n\n5. 의도 요약:\n- {{intent-summary-text}}\n\n6. 이전 개선점 (선택적):\n{{improvements}}\n\n## [AI PROMPT]\n\nYou are performing problem decomposition.\n\nRules:\n- No solution framing.\n- No implementation hints.\n- Consider the full context from Dumping, WhatToDo, and DefiningIntent phases.\n\nPriority Principle:\n- **Problems that rarely change must be resolved first.**\n- When ranking problems, prioritize stability: problems with stable requirements, clear boundaries, and minimal expected changes should be addressed before problems that are likely to evolve.\n- This reduces rework and establishes a solid foundation.\n\nTasks:\n1. Review the thoughts from Dumping phase, the action intent, reasons, and assumptions.\n2. Enumerate all problems implied by the intent summary and underlying context.\n3. For each problem, assess its expected change frequency:\n   - Stable problems: clear boundaries, well-understood requirements, minimal expected changes\n   - Volatile problems: evolving requirements, unclear boundaries, likely to change\n4. Rank problems by:\n   - **Primary: Change frequency (stable first)**\n   - Secondary: Urgency, impact, and dependency depth\n   - Consider alignment with the reasons and assumptions from DefiningIntent\n5. Select exactly ONE problem (prefer the most stable one that is still actionable).\n6. Rewrite it as a single precise question.\n7. If oversized, decompose and select the smallest viable unit.\n8. If improvement points are provided, consider them in problem selection.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- One problem only\n- Expressed as a question\n- Solvable independently\n- Change frequency assessment included\n- Aligned with intent and assumptions",
          "selectableAnswers": {
            "questionId": "learned-improvements-text",
            "label": "이전 개선점 선택",
            "variableName": "improvements"
          }
        }
      },
      {
        "id": "problem-distinct",
        "question": "문제가 Intent와 구별되나요? (Intent는 큰 그림, 문제는 구체적)",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "problem-measurable",
        "onNoNextSituation": "DefiningIntent",
        "showData": {
          "type": "intent-summary",
          "label": "기존 Intent 요약",
          "source": "getIntentSummary"
        }
      },
      {
        "id": "problem-measurable",
        "question": "문제를 해결했는지 알 수 있나요? (측정 가능한가요?)",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "DefiningAcceptance",
        "onNoNextQuestionId": "problem-measurable"
      }
    ]
  },
  "DefiningAcceptance": {
    "situation": "DefiningAcceptance",
    "startQuestionId": "criteria-text",
    "questions": [
      {
        "id": "criteria-text",
        "question": "완료 기준을 작성해주세요 (Given-When-Then 형식 권장)",
        "type": "text",
        "required": true,
        "nextQuestionId": "criteria-measurable",
        "aiPromptTemplate": {
          "template": "# 완료 기준(Acceptance Criteria) 정의 도움\n\n## [INPUT – Human]\n\n1. Selected problem:\n- {{problem}}\n\n## [AI PROMPT]\n\nYou are defining verification contracts.\n\nRules:\n- Each criterion must be objectively testable.\n- No subjective or vague wording.\n\nTasks:\n1. Generate 3–5 Given–When–Then acceptance criteria.\n2. Validate testability of each criterion.\n3. Rewrite non-testable criteria.\n4. Mark logical dependencies between criteria.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Criteria are testable\n- Completion is objectively decidable"
        }
      },
      {
        "id": "criteria-measurable",
        "question": "각 기준을 true/false로 확인할 수 있나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "criteria-linked",
        "onNoNextSituation": "SelectingProblem"
      },
      {
        "id": "criteria-linked",
        "question": "기준이 문제와 연결되어 있나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "criteria-define-done",
        "onNoNextSituation": "SelectingProblem"
      },
      {
        "id": "criteria-define-done",
        "question": "기준으로 \"완료\"를 알 수 있나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "criteria-count",
        "onNoNextSituation": "SelectingProblem"
      },
      {
        "id": "criteria-count",
        "question": "기준이 3-7개 정도인가요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "CheckingFeasibility",
        "onNoNextQuestionId": "criteria-count"
      }
    ]
  },
  "CheckingFeasibility": {
    "situation": "CheckingFeasibility",
    "startQuestionId": "problem-select",
    "questions": [
      {
        "id": "problem-select",
        "question": "검증할 문제를 선택해주세요",
        "type": "text",
        "required": true,
        "nextQuestionId": "constraints-text",
        "aiPromptTemplate": {
          "template": "",
          "selectableAnswers": {
            "questionId": "problem-boundaries-text",
            "label": "이전 문제 목록",
            "variableName": "selectedProblemId"
          }
        }
      },
      {
        "id": "constraints-text",
        "question": "기술적 제약사항을 작성해주세요",
        "type": "text",
        "required": true,
        "nextQuestionId": "resources-text",
        "aiPromptTemplate": {
          "template": "# 실행 가능성 검증 및 리스크 분석 도움\n\n## [INPUT – Human]\n\n1. Problem + acceptance criteria:\n- Problem: {{problem}}\n- Acceptance Criteria: {{acceptanceCriteria}}\n\n## [AI PROMPT]\n\nYou are performing risk intelligence analysis.\n\nRules:\n- Expose risk, do not hide it.\n- Focus on learning, not safety.\n\nTasks:\n1. Identify technical, time, and dependency risks.\n2. Rank risks by failure impact.\n3. Select the SINGLE highest-risk assumption.\n4. Define the smallest experiment to validate it.\n5. Describe what failure would teach.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- One dominant risk identified\n- One learning experiment defined"
        }
      },
      {
        "id": "resources-text",
        "question": "리소스 요구사항을 작성해주세요",
        "type": "text",
        "required": true,
        "nextQuestionId": "feasibility-decision",
        "aiPromptTemplate": {
          "template": "# 리소스 요구사항 추정 도움\n\n## [INPUT – Human]\n\n1. Problem + acceptance criteria:\n- Problem: {{problem}}\n- Acceptance Criteria: {{acceptanceCriteria}}\n- Technical Constraints: {{constraints-text}}\n\n## [AI PROMPT]\n\nYou are estimating resource requirements.\n\nTasks:\n1. Estimate time requirements (hours/days).\n2. Estimate human resources needed.\n3. Identify external dependencies.\n4. Define resource constraints.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Time estimate provided\n- Resource dependencies identified"
        }
      },
      {
        "id": "feasibility-decision",
        "question": "결정을 내렸나요?",
        "type": "multiple",
        "required": true,
        "options": ["feasible", "too hard", "problem too big"]
      }
    ]
  },
  "Designing": {
    "situation": "Designing",
    "startQuestionId": "design-text",
    "questions": [
      {
        "id": "design-text",
        "question": "최소 구조/인터페이스 설계를 작성해주세요 (d2 언어 권장)",
        "type": "text",
        "required": true,
        "nextQuestionId": "design-covers-criteria",
        "aiPromptTemplate": {
          "template": "# 최소 설계(Design) 작성 도움\n\n## [INPUT – Human]\n\n1. Acceptance criteria:\n- {{acceptanceCriteria}}\n\n## [AI PROMPT]\n\nYou are designing a minimal execution architecture.\n\nPrimary Goal:\n- Satisfy acceptance criteria with the simplest possible structure.\n\nRules:\n- Design ONLY what acceptance requires.\n- No future-proofing.\n- No speculative features.\n- Design patterns are OPTIONAL, not mandatory.\n- Patterns must never drive the design; acceptance criteria do.\n- Write design with d2 lang (diagram modeling language: https://d2lang.com/)\n\nPriority Principle:\n- **Components that rarely change must be designed first.**\n- When defining components, prioritize stability: components with stable interfaces, clear responsibilities, and minimal expected changes should be designed before components that are likely to evolve.\n- This reduces redesign work and establishes a solid architectural foundation.\n\nTasks:\n1. Define minimal components (maximum 5).\n2. For each component, assess its expected change frequency:\n   - Stable components: clear responsibilities, well-defined interfaces, minimal expected changes\n   - Volatile components: evolving interfaces, unclear responsibilities, likely to change\n3. Describe state transitions or data flow between components.\n4. Map each acceptance criterion to the responsible component.\n5. **Design order: Design stable components first, then volatile ones.**\n\nDesign Pattern Evaluation:\n6. List relevant design pattern candidates (for example: State, Strategy, Pipeline, Observer, Command).\n7. For each candidate pattern:\n   - Why it could fit this problem\n   - What problem it would solve\n   - What complexity it would introduce\n8. Explicitly decide:\n   - Pattern selected (if any) and justification\n   - Patterns rejected and reasons for rejection\n\nSimplification:\n9. Identify unnecessary abstractions or indirections.\n10. Propose a simpler structure if possible.\n11. Explain how the design could be simplified further if requirements were reduced.\n\nOutput Constraint:\n- The design must make implementation order naturally inferable.\n- The design must be explainable without referencing patterns.\n- Component change frequency assessment must be included.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Structure is minimal\n- State or data flow is explicit\n- Design decisions (including pattern usage or rejection) are justified\n- Implementation order is obvious\n- Component change frequency assessment included"
        }
      },
      {
        "id": "design-covers-criteria",
        "question": "설계가 완료 기준을 다루나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "design-ready-to-implement",
        "onNoNextSituation": "DefiningAcceptance"
      },
      {
        "id": "design-ready-to-implement",
        "question": "구현을 시작할 수 있을 정도인가요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "BreakingTasks",
        "onNoNextSituation": "DefiningAcceptance"
      }
    ]
  },
  "BreakingTasks": {
    "situation": "BreakingTasks",
    "startQuestionId": "tasks-text",
    "questions": [
      {
        "id": "tasks-text",
        "question": "작업을 수십 분~몇 시간 단위로 분해해주세요 (시작 상태 → 행동 → 종료 상태)",
        "type": "text",
        "required": true,
        "nextQuestionId": "tasks-independent",
        "aiPromptTemplate": {
          "template": "# 작업 분해(Task Breakdown) 도움\n\n## [INPUT – Human]\n\n1. Design output:\n- {{design}}\n\n## [AI PROMPT]\n\nYou are generating executable micro-tasks.\n\nDefinition:\nA task is a single state change with a verifiable outcome.\n\nRules:\n- Less than 90 minutes per task\n- Single responsibility\n- One verification method\n\nPriority Principle:\n- **Implementations that rarely change must be implemented first.**\n- When ordering tasks, prioritize stability: tasks that implement stable components, interfaces, or core functionality with minimal expected changes should be executed before tasks that are likely to require rework.\n- This reduces implementation rework and establishes a solid foundation.\n\nTasks:\n1. Decompose design into atomic tasks.\n2. For each task define:\n   - start state\n   - action\n   - end state\n3. For each task, assess its expected change frequency:\n   - Stable tasks: implement stable components/interfaces, core functionality, minimal expected changes\n   - Volatile tasks: implement evolving features, experimental functionality, likely to change\n4. Order tasks by:\n   - **Primary: Change frequency (stable first)**\n   - Secondary: Dependency relationships\n5. Identify parallelizable tasks.\n6. Flag vague or oversized tasks.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Tasks are immediately executable\n- Dependencies are explicit\n- Change frequency assessment included\n- Task ordering reflects stability priority"
        }
      },
      {
        "id": "tasks-independent",
        "question": "각 작업이 독립적으로 실행 가능한가요? (명확한 입력/출력)",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "tasks-session-sized",
        "onNoNextSituation": "Designing"
      },
      {
        "id": "tasks-session-sized",
        "question": "각 작업을 90분 안에 완료할 수 있나요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "Implementing",
        "onNoNextQuestionId": "tasks-session-sized"
      }
    ]
  },
  "Implementing": {
    "situation": "Implementing",
    "startQuestionId": "task-implementation-text",
    "questions": [
      {
        "id": "task-implementation-text",
        "question": "현재 작업의 구현 내용을 작성해주세요 (코드 스켈레톤, 주요 로직 등)",
        "type": "text",
        "required": true,
        "nextQuestionId": "task-complete",
        "aiPromptTemplate": {
          "template": "# 구현(Implementation) 도움\n\n## [INPUT – Human]\n\n1. Current task:\n- {{task}}\n\n## [AI PROMPT]\n\nYou are assisting implementation.\n\nRules:\n- No system redesign.\n- No scope expansion.\n\nTasks:\n1. Produce a minimal implementation skeleton.\n2. Identify failure-prone areas.\n3. Define quick sanity checks.\n4. Suggest fast validation steps.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Code runs\n- Task end state achieved"
        }
      },
      {
        "id": "task-complete",
        "question": "작업이 완료되었나요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "Verifying",
        "onNoNextQuestionId": "task-stuck"
      },
      {
        "id": "task-stuck",
        "question": "막혔나요? (15분 이상 고민 중)",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "task-stuck-reason",
        "onNoNextQuestionId": "task-complete"
      },
      {
        "id": "task-stuck-reason",
        "question": "막힌 이유를 선택하세요",
        "type": "multiple",
        "required": true,
        "options": ["작업 분해 필요", "새로운 문제 발견", "기술적 제약 발견"]
      }
    ]
  },
  "Verifying": {
    "situation": "Verifying",
    "startQuestionId": "verification-test-text",
    "questions": [
      {
        "id": "verification-test-text",
        "question": "검증 테스트를 작성해주세요 (테스트 코드 또는 재현 가능한 테스트 절차)",
        "type": "text",
        "required": true,
        "nextQuestionId": "verification-improvement-ideas",
        "aiPromptTemplate": {
          "template": "# 검증(Verification) 도움\n\n## [INPUT – Human]\n\n1. Implementation + acceptance criteria:\n- Implementation: {{task-implementation-text}}\n- Acceptance Criteria: {{acceptanceCriteria}}\n\n## [AI PROMPT]\n\nYou are validating correctness.\n\nTasks:\n1. Generate verification tests.\n2. Define observable success signals.\n3. Define observable failure signals.\n4. Classify failure origin:\n   - implementation fault\n   - acceptance fault\n   - design fault\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Tests are reproducible\n- Results are evidence-based"
        }
      },
      {
        "id": "verification-improvement-ideas",
        "question": "개선점, 구현 방법, 또는 검증 방법이 떠오르나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "verification-go-to-implementation",
        "onNoNextQuestionId": "all-criteria-met"
      },
      {
        "id": "verification-go-to-implementation",
        "question": "Implementation으로 돌아가시겠습니까? (연속 최대 5회)",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "Implementing",
        "onNoNextQuestionId": "all-criteria-met"
      },
      {
        "id": "all-criteria-met",
        "question": "모든 기준이 만족되었나요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "Verified",
        "onNoNextQuestionId": "bugs-found"
      },
      {
        "id": "bugs-found",
        "question": "버그가 발견되었나요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "Implementing",
        "onNoNextQuestionId": "all-criteria-met"
      }
    ]
  },
  "Verified": {
    "situation": "Verified",
    "startQuestionId": "verification-decision-text",
    "questions": [
      {
        "id": "verification-decision-text",
        "question": "검증 결과와 판단 근거를 작성해주세요",
        "type": "text",
        "required": true,
        "nextQuestionId": "ready-for-release",
        "aiPromptTemplate": {
          "template": "# 검증 완료 판단 도움\n\n## [INPUT – Human]\n\n1. Test results:\n- {{verification-test-text}}\n\n## [AI PROMPT]\n\nYou are performing decision analysis.\n\nTasks:\n1. Evaluate acceptance satisfaction.\n2. Decide pass or fail.\n3. If failed:\n   - identify broken assumption\n   - specify rollback stage\n4. Justify decision logically.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Clear yes or no decision\n- Rollback path defined"
        }
      },
      {
        "id": "ready-for-release",
        "question": "다음 단계(릴리스) 준비가 되었나요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "Releasing",
        "onNoNextQuestionId": "ready-for-release"
      }
    ]
  },
  "Releasing": {
    "situation": "Releasing",
    "startQuestionId": "release-note-text",
    "questions": [
      {
        "id": "release-note-text",
        "question": "릴리스 노트를 작성해주세요 (최소 릴리스 노트, 알려진 제한사항 포함)",
        "type": "text",
        "required": true,
        "nextQuestionId": "release-announced",
        "aiPromptTemplate": {
          "template": "# 릴리스(Release) 준비 도움\n\n## [INPUT – Human]\n\n1. Verified solution:\n- Problem: {{problem}}\n- Solution: {{task-implementation-text}}\n\n## [AI PROMPT]\n\nYou are preparing delivery.\n\nTasks:\n1. Generate a minimal release note.\n2. Define known limitations.\n3. Create a release checklist.\n4. Identify deployment risks.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Delivered to real user or system"
        }
      },
      {
        "id": "release-announced",
        "question": "릴리스가 공지되었나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "cycle-complete",
        "onNoNextQuestionId": "release-announced"
      },
      {
        "id": "cycle-complete",
        "question": "이번 Cycle을 완료하시겠습니까?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "CollectingFeedback",
        "onNoNextQuestionId": "cycle-complete"
      }
    ]
  },
  "CollectingFeedback": {
    "situation": "CollectingFeedback",
    "startQuestionId": "feedback-documented-text",
    "questions": [
      {
        "id": "feedback-documented-text",
        "question": "피드백을 작성해주세요",
        "type": "text",
        "required": true,
        "nextSituation": "Learning",
        "aiPromptTemplate": {
          "template": "# 피드백 수집 및 문서화 도움\n\n## [INPUT – Human]\n\n1. Feedback and observations:\n- Intent: {{intent}}\n- Released solution: {{problem}}\n- Release note: {{release-note-text}}\n\n## [AI PROMPT]\n\nYou are extracting learning.\n\nTasks:\n1. Compare expectation versus reality.\n2. Identify incorrect assumptions.\n3. Propose updates to:\n   - intent\n   - problem\n   - acceptance\n4. Extract reusable lessons.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Learning captured\n- Next cycle defined"
        }
      }
    ]
  },
  "Learning": {
    "situation": "Learning",
    "startQuestionId": "learned-new-facts",
    "questions": [
      {
        "id": "learned-new-facts",
        "question": "새롭게 알아낸 사실이 있나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "learned-new-facts-text",
        "onNoNextQuestionId": "learned-improvements"
      },
      {
        "id": "learned-new-facts-text",
        "question": "어떤 사실을 새롭게 알아냈나요?",
        "type": "text",
        "required": true,
        "nextQuestionId": "learned-improvements",
        "aiPromptTemplate": {
          "template": "# 학습 내용 추출 도움\n\n## [INPUT – Human]\n\n1. Feedback and observations:\n- Intent: {{intent}}\n- Problem: {{problem}}\n- Feedback: {{feedback-documented-text}}\n\n## [AI PROMPT]\n\nYou are extracting learning.\n\nTasks:\n1. Compare expectation versus reality.\n2. Identify incorrect assumptions.\n3. Extract reusable lessons.\n4. Identify patterns in failures or successes.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Learning captured\n- Assumptions updated"
        }
      },
      {
        "id": "learned-improvements",
        "question": "개선할 점을 찾았나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "learned-improvements-text",
        "onNoNextQuestionId": "learned-clear-implementation"
      },
      {
        "id": "learned-improvements-text",
        "question": "어떤 점을 개선할 수 있나요?",
        "type": "text",
        "required": true,
        "nextQuestionId": "learned-feedback-issues-list",
        "aiPromptTemplate": {
          "template": "# 개선점 도출 도움\n\n## [INPUT – Human]\n\n1. Learning and feedback:\n- New facts: {{learned-new-facts-text}}\n- Feedback: {{feedback-documented-text}}\n- Intent: {{intent}}\n- Problem: {{problem}}\n\n## [AI PROMPT]\n\nYou are identifying improvement opportunities.\n\nTasks:\n1. Analyze gaps between intent and reality.\n2. Identify improvement opportunities.\n3. Propose updates to:\n   - intent\n   - problem\n   - acceptance criteria\n4. Prioritize improvements by impact.\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- Improvement opportunities identified\n- Next cycle defined"
        }
      },
      {
        "id": "learned-feedback-issues-list",
        "question": "피드백과 이슈 목록을 작성해주세요 (각 항목을 개별적으로 입력)",
        "type": "list",
        "required": false,
        "nextQuestionId": "learned-next-improvement-recommendation",
        "aiPromptTemplate": {
          "template": "# 다음 개선 항목 추천\n\n## [INPUT – Human]\n\n1. Feedback and Issues List:\n{{learned-feedback-issues-list}}\n\n2. Improvement Opportunities:\n{{learned-improvements-text}}\n\n3. Context:\n- Intent: {{intent}}\n- Problem: {{problem}}\n- New Facts: {{learned-new-facts-text}}\n- Feedback: {{feedback-documented-text}}\n\n## [AI PROMPT]\n\nYou are a product strategist analyzing feedback and issues to recommend the next improvement item.\n\nScoring Framework:\n\n**Essential Features (High Priority):**\n- Core functionality that must work for the product to be usable\n- Blocking issues that prevent users from achieving their goals\n- Critical bugs or missing fundamental features\n- Security or data integrity concerns\n- Compliance or legal requirements\n- Score: 8-10 points\n\n**Modifiable Features (Medium Priority):**\n- Enhancements that improve user experience but aren't critical\n- Nice-to-have features that add value\n- Performance optimizations\n- UI/UX improvements\n- Non-blocking bugs or edge cases\n- Score: 4-7 points\n\n**Optional Features (Low Priority):**\n- Cosmetic changes\n- Future enhancements\n- Experimental features\n- Score: 1-3 points\n\nTasks:\n1. Analyze each item in the Feedback and Issues List.\n2. For each item, classify it as:\n   - Essential Feature (must-have, core functionality)\n   - Modifiable Feature (nice-to-have, can be changed)\n   - Optional Feature (cosmetic, future enhancement)\n3. Score each item (1-10 scale) based on:\n   - Impact on user goals\n   - Urgency (blocking vs. enhancement)\n   - Effort vs. value ratio\n   - Alignment with intent\n4. Rank all items by priority score.\n5. Recommend the TOP 1 item to improve next with:\n   - Item description\n   - Classification (Essential/Modifiable/Optional)\n   - Score and reasoning\n   - Why this should be prioritized\n   - Suggested next steps\n\nOutput Format:\n- For each item: [Item] | [Classification] | [Score] | [Reasoning]\n- Top Recommendation: [Item] | [Detailed Analysis]\n\n## [OUTPUT FORMAT]\n\n- Output the answer as a copyable markdown code block or d2 code block\n- Use a list instead of a table\n- Do not nest d2 code blocks inside markdown code blocks\n\n## [EXIT CONDITION]\n\n- All items scored and classified\n- Top recommendation clearly identified\n- Reasoning provided for prioritization"
        }
      },
      {
        "id": "learned-next-improvement-recommendation",
        "question": "AI가 추천한 다음 개선 항목을 확인하셨나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "learned-clear-implementation",
        "onNoNextQuestionId": "learned-clear-implementation"
      },
      {
        "id": "learned-clear-implementation",
        "question": "바로 어떻게 개선해야할지 떠오르나요?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "Implementing",
        "onNoNextQuestionId": "learned-next-action"
      },
      {
        "id": "learned-next-action",
        "question": "다음 행동을 선택하세요",
        "type": "multiple",
        "required": true,
        "options": ["새로운 문제 선택", "같은 문제 심화", "Intent 조정", "완료"]
      }
    ]
  },
  "Ending": {
    "situation": "Ending",
    "startQuestionId": "cycle-finished",
    "questions": [
      {
        "id": "cycle-finished",
        "question": "이번 Cycle이 완료되었습니다. 새로운 Cycle을 시작하시겠습니까?",
        "type": "yesno",
        "required": true,
        "onYesNextSituation": "Dumping",
        "onNoNextQuestionId": "cycle-finished"
      }
    ]
  },
  "Undetermined": {
    "situation": "Undetermined",
    "startQuestionId": "info-missing",
    "questions": [
      {
        "id": "info-missing",
        "question": "어떤 정보가 누락되었나요?",
        "type": "text",
        "required": true,
        "nextQuestionId": "info-can-collect"
      },
      {
        "id": "info-can-collect",
        "question": "필요한 정보를 수집할 수 있나요?",
        "type": "yesno",
        "required": true,
        "onYesNextQuestionId": "info-collect-plan",
        "onNoNextQuestionId": "closest-situation"
      },
      {
        "id": "info-collect-plan",
        "question": "정보 수집 계획을 작성해주세요",
        "type": "text",
        "required": true,
        "nextQuestionId": "closest-situation"
      },
      {
        "id": "closest-situation",
        "question": "가장 가까운 상황이 무엇인가요?",
        "type": "multiple",
        "required": true,
        "options": ["DefiningIntent", "SelectingProblem", "DefiningAcceptance", "CheckingFeasibility", "Designing", "BreakingTasks", "Implementing", "Verifying", "Verified", "Releasing", "CollectingFeedback", "Learning"]
      }
    ]
  }
}
